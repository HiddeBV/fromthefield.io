<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <!-- SEO Meta Tags -->
  <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
  <meta name="description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
  <meta name="author" content="{{ site.podcast.author }}">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="{{ page.url | absolute_url }}">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="{{ page.url | absolute_url }}">
  <meta property="og:title" content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}">
  <meta property="og:description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
  <meta property="og:image" content="{% if page.image %}{{ page.image | absolute_url }}{% else %}{{ '/assets/images/og-image.jpg' | absolute_url }}{% endif %}">
  <meta property="og:site_name" content="{{ site.title }}">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="{{ page.url | absolute_url }}">
  <meta name="twitter:title" content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}">
  <meta name="twitter:description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
  <meta name="twitter:image" content="{% if page.image %}{{ page.image | absolute_url }}{% else %}{{ '/assets/images/og-image.jpg' | absolute_url }}{% endif %}">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  
  <!-- Preload critical assets -->
  <link rel="preload" href="/assets/css/main.css" as="style">
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="/assets/css/main.css">
  
  <!-- Theme Script (inline to prevent flash) -->
  <script>
    // Apply saved theme immediately to prevent flash
    (function() {
      const savedTheme = localStorage.getItem('theme');
      const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      const theme = savedTheme || systemTheme;
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>
  
  <!-- Jekyll SEO Tag -->
  {% seo %}
  
  <!-- RSS Feed -->
  <link rel="alternate" type="application/rss+xml" title="{{ site.title }}" href="{{ '/feed.xml' | absolute_url }}">
  
  <!-- Structured Data - Site -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "{{ site.title }}",
    "description": "{{ site.description }}",
    "url": "{{ site.url }}",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "{{ site.url }}/episodes?search={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  
  <!-- Structured Data - Organization -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "{{ site.title }}",
    "url": "{{ site.url }}",
    "logo": "{{ '/assets/images/logo.png' | absolute_url }}",
    "sameAs": {{ site.social.links | jsonify }}
  }
  </script>
  
  {% if page.podcast_episode %}
  <!-- Structured Data - Podcast Episode -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "PodcastEpisode",
    "url": "{{ page.url | absolute_url }}",
    "name": "{{ page.title }}",
    "description": "{{ page.description }}",
    "datePublished": "{{ page.date | date_to_xmlschema }}",
    "partOfSeries": {
      "@type": "PodcastSeries",
      "name": "{{ site.title }}",
      "url": "{{ site.url }}"
    }
  }
  </script>
  {% endif %}
</head>
<body>
  <!-- Skip Link for Accessibility -->
  <a href="#main-content" class="skip-link">Skip to main content</a>
  
  <!-- Header -->
  {% include header.html %}
  
  <!-- Main Content -->
  <main id="main-content" role="main">
    {{ content }}
  </main>
  
  <!-- Footer -->
  {% include footer.html %}
  
  <!-- JavaScript -->
  <script src="/assets/js/main.js"></script>
</body>
</html>
