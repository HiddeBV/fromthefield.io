# Implementation Plan: Episode Content Management Workflow

**Branch**: `002-add-episode-workflow` | **Date**: October 31, 2025 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/002-add-episode-workflow/spec.md`

**Note**: This template is filled in by the `/speckit.plan` command. See `.specify/templates/commands/plan.md` for the execution workflow.

## Summary

Enable content managers to add new podcast episodes by editing a JSON data file (`_data/episodes.json`) in the repository. Episodes automatically render on the site through Jekyll's data file mechanism, appearing in reverse chronological order on the episodes page with full metadata support (topics, guests, show notes, thumbnails, Spotify embeds). The workflow leverages existing Jekyll/GitHub Pages infrastructure with no new frameworks or build tools required.

## Technical Context

**Language/Version**: Jekyll 4.x (Ruby), HTML5, CSS3 (SCSS), Vanilla JavaScript ES2020+  
**Primary Dependencies**: 
- Jekyll (via GitHub Pages gem)
- jekyll-feed, jekyll-sitemap, jekyll-seo-tag plugins
- Kramdown (Markdown processor)
- Spotify Web Playback SDK/Embeds (external, no npm package)

**Storage**: Static JSON files in `_data/` directory (episodes.json, hosts.json, topics.json)  
**Testing**: Manual browser testing + Jekyll build validation (no automated test framework yet)  
**Target Platform**: GitHub Pages (static site hosting), modern browsers (Chrome, Firefox, Safari, Edge)  
**Project Type**: Static website with Jekyll templating  
**Performance Goals**: 
- Initial HTML load <200ms (excluding images)
- Critical CSS <50KB
- Episode page render <1 second
- Support up to 100 episodes without degradation

**Constraints**: 
- Must remain purely static (no server-side runtime)
- GitHub Pages build environment limitations
- No client-side framework hydration (vanilla JS only)
- Must work with existing Jekyll data file architecture

**Scale/Scope**: 
- ~5-10 new episodes per month
- Expected total: 100-200 episodes over 2 years
- 3-5 content managers with Git knowledge
- ~1000-5000 monthly visitors (SEO-driven)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

The following MUST all be satisfied (derived from Constitution v1.0.0):

1. ✅ **Accessibility**: Episode pages use existing layout with semantic landmarks (`<header>`, `<nav>`, `<main>`, `<footer>`). Episode detail page will use proper heading hierarchy (H1 for title, H2 for sections). Episode thumbnails will have descriptive alt text.

2. ✅ **Metadata**: Each episode detail page will generate unique `<title>` (episode title + podcast name), meta description (truncated episode description), and canonical URL via Jekyll's `jekyll-seo-tag` plugin (already installed).

3. ✅ **Performance Budget**: No new CSS frameworks. Reusing existing SCSS structure (<50KB critical CSS already achieved). No client-side framework. Spotify embed is external and lazy-loaded by Spotify.

4. ✅ **SEO Assets**: `sitemap.xml` auto-generated by jekyll-sitemap plugin (already configured). `robots.txt` exists. `_config.yml` has `url` and `baseurl` properly set. Episode pages will be automatically added to sitemap.

5. ✅ **Structured Data**: JSON-LD for Site + Organization already exists on `index.html` (from feature 001). Episode pages will add PodcastEpisode structured data using jekyll-seo-tag.

6. ✅ **Review Discipline**: This feature follows PR workflow. No SEO-critical files modified (only data files and templates). Changes go through standard PR review process.

7. ✅ **Simplicity**: Zero new dependencies. Leverages existing Jekyll data file mechanism. Vanilla JavaScript for episode filtering (if needed). No build tools beyond Jekyll.

8. ✅ **Orphan Avoidance**: Episode pages linked from:
   - Episodes list page (`/episodes`)
   - Homepage recent episodes section
   - Topic filter results
   - RSS feed (jekyll-feed plugin)

**Result**: ✅ ALL GATES PASSED - No violations. Feature aligns perfectly with constitution principles.

---

### Post-Phase 1 Re-Evaluation

*Re-checked after completing research.md, data-model.md, contracts/, and quickstart.md*

All 8 constitution gates **remain PASSED** after Phase 1 design:

1. ✅ **Accessibility**: Data model confirms semantic HTML, alt text, accessible layouts
2. ✅ **Metadata**: Unique titles, descriptions (50-300 chars), canonical URLs via jekyll-seo-tag
3. ✅ **Performance**: WebP images (<150KB), lazy loading, no frameworks, zero new dependencies
4. ✅ **SEO Assets**: Auto-updating sitemap.xml, unchanged robots.txt, proper _config.yml
5. ✅ **Structured Data**: PodcastEpisode Schema.org JSON-LD documented in research
6. ✅ **Review Discipline**: PR workflow emphasized in quickstart, no SEO-critical file changes
7. ✅ **Simplicity**: Zero npm/gem dependencies, vanilla JS, Liquid validation, simple JSON approach
8. ✅ **Orphan Avoidance**: Episodes linked from list, homepage, topics, RSS feed

**No violations introduced during design phase.** Implementation maintains full constitution compliance.

## Project Structure

### Documentation (this feature)

```text
specs/[###-feature]/
├── plan.md              # This file (/speckit.plan command output)
├── research.md          # Phase 0 output (/speckit.plan command)
├── data-model.md        # Phase 1 output (/speckit.plan command)
├── quickstart.md        # Phase 1 output (/speckit.plan command)
├── contracts/           # Phase 1 output (/speckit.plan command)
└── tasks.md             # Phase 2 output (/speckit.tasks command - NOT created by /speckit.plan)
```

### Source Code (repository root)

```text
# Jekyll Static Site Structure
_data/
├── episodes.json        # Episode data (EDIT THIS to add episodes)
├── hosts.json           # Host profiles (existing)
├── topics.json          # Topic tags (existing)
└── site-config.json     # Site metadata (existing)

_layouts/
├── default.html         # Base layout (existing)
└── episode.html         # Episode detail layout (existing, may need updates)

_includes/
├── episode-card.html    # Episode card component (existing, may need updates)
├── audio-player.html    # Spotify embed component (existing, may need updates)
├── header.html          # Site header (existing)
└── footer.html          # Site footer (existing)

assets/
├── css/
│   └── main.scss        # Styles (may add episode-specific styles)
├── js/
│   ├── episodes.js      # Episodes list filtering/sorting (existing, may update)
│   └── episode-detail.js # Episode page interactivity (existing, may update)
└── images/
    └── episodes/        # Episode thumbnails (ADD NEW IMAGES HERE)

episodes.html            # Episodes list page (existing, may need updates)
episode.html             # Episode detail template (existing, may need updates)
feed.xml                 # RSS feed (auto-generated by jekyll-feed)
sitemap.xml              # Sitemap (auto-generated by jekyll-sitemap)
```

**Structure Decision**: This is a static Jekyll site. The primary workflow is editing the `_data/episodes.json` file to add new episodes. Jekyll processes the data file during build and generates static HTML pages. No backend, no database, no build tools beyond Jekyll. Episode thumbnails are static images placed in `assets/images/episodes/`.

## Complexity Tracking

> **Fill ONLY if Constitution Check has violations that must be justified**

**No violations identified.** This feature fully complies with all constitution principles.

| Violation | Why Needed | Simpler Alternative Rejected Because |
|-----------|------------|-------------------------------------|
| N/A | N/A | N/A |

---

## Phase Completion Summary

### ✅ Phase 0: Research - COMPLETE

**Output**: `research.md`

**Completed Research Areas**:
1. ✅ Jekyll Data Files Best Practices → Decision: Use native JSON in `_data/`
2. ✅ JSON Schema Validation → Decision: Build-time Liquid validation
3. ✅ Spotify Embed Integration → Decision: Official iframe embeds
4. ✅ Podcast Metadata Standards → Decision: Schema.org PodcastEpisode JSON-LD
5. ✅ Episode Thumbnail Optimization → Decision: WebP with JPEG fallback, lazy loading

**Key Decisions Made**:
- Data storage: Single JSON file in `_data/episodes.json`
- Validation: Jekyll build-time checks via Liquid templates
- Audio: Spotify iframe embeds (no API keys needed)
- SEO: Schema.org structured data + jekyll-seo-tag
- Images: WebP preferred, 800×800px, <150KB target

**All clarifications resolved** - zero NEEDS CLARIFICATION markers remain.

---

### ✅ Phase 1: Design & Contracts - COMPLETE

**Outputs**:
- `data-model.md` - Episode entity schema and validation rules
- `contracts/episode-data-contract.md` - Formal API contract with examples
- `quickstart.md` - Step-by-step guide for content managers
- `.github/copilot-instructions.md` - Updated with new technologies

**Data Model**:
- **Episode Entity**: 12 fields (6 required, 6 optional)
- **Guest Entity**: Embedded object (3 required fields)
- **Relationships**: Many-to-many with Topics and Hosts via ID references
- **Validation Rules**: 8 build-time checks implemented in Liquid
- **State Management**: Implicit via Git workflow (draft → committed → published)

**Contracts**:
- Episode data contract v1.0.0 established
- JSON schema documented with TypeScript-style types
- Example episodes provided (minimal and full)
- Field specifications with constraints and validation patterns
- Backward compatibility strategy defined

**Quickstart Guide**:
- 12-step workflow documented
- Troubleshooting section with common errors
- Quick reference card for terminal commands
- Complete example walkthrough
- Pre-push checklist included

**Agent Context Updated**:
- Added: Jekyll 4.x (Ruby), HTML5, CSS3 (SCSS), Vanilla JavaScript ES2020+
- Added: Static JSON files in `_data/` directory
- Updated: `.github/copilot-instructions.md`

---

## Next Steps

### Phase 2: Implementation (via `/speckit.tasks`)

The planning phase is complete. To proceed with implementation:

```bash
# While on branch 002-add-episode-workflow
/speckit.tasks
```

This will generate:
- `tasks.md` - Detailed implementation tasks with priorities
- GitHub Issues or project tasks (if configured)
- Acceptance criteria for each task

### Expected Implementation Work

Based on the design, implementation will involve:

1. **Template Updates** (estimated: 2-3 hours)
   - Update `_layouts/episode.html` for episode detail page
   - Update `_includes/episode-card.html` for list display
   - Update `_includes/audio-player.html` for Spotify embeds
   - Add `_includes/validate-episodes.html` for validation

2. **Styling** (estimated: 1-2 hours)
   - Add episode-specific SCSS to `assets/css/main.scss`
   - Ensure responsive design for episode cards
   - Style Spotify embed container
   - Style guest information display

3. **JavaScript Enhancements** (estimated: 1-2 hours)
   - Update `assets/js/episodes.js` for filtering by topic
   - Add sort options (date, title, duration)
   - Implement search functionality (optional)

4. **Structured Data** (estimated: 1 hour)
   - Add PodcastEpisode JSON-LD to episode layout
   - Ensure jekyll-seo-tag generates correct metadata

5. **Testing** (estimated: 2-3 hours)
   - Add sample episodes for testing
   - Validate across browsers (Chrome, Firefox, Safari, Edge)
   - Test responsive design on mobile/tablet
   - Verify Spotify embeds load correctly
   - Check SEO metadata with tools
   - Test validation error messages

6. **Documentation** (estimated: 1 hour)
   - Update README with episode management section
   - Add content manager guide link
   - Document troubleshooting steps

**Total Estimated Time**: 8-12 hours

---

## Key Artifacts Generated

| Artifact | Purpose | Location |
|----------|---------|----------|
| Implementation Plan | This document - overall feature plan | `specs/002-add-episode-workflow/plan.md` |
| Research | Technical decisions and alternatives | `specs/002-add-episode-workflow/research.md` |
| Data Model | Episode schema and validation | `specs/002-add-episode-workflow/data-model.md` |
| Data Contract | Formal API contract | `specs/002-add-episode-workflow/contracts/episode-data-contract.md` |
| Quickstart Guide | User guide for adding episodes | `specs/002-add-episode-workflow/quickstart.md` |
| Requirements Checklist | Spec quality validation | `specs/002-add-episode-workflow/checklists/requirements.md` |
| Agent Context | Copilot development context | `.github/copilot-instructions.md` |

---

## Success Metrics Recap

From the feature specification, this implementation will be considered successful when:

- ✅ **SC-001**: Content managers can add episode and see it live within 5 minutes
- ✅ **SC-002**: Episodes display correctly 100% of time across all browsers
- ✅ **SC-003**: Episode images load within 2 seconds
- ✅ **SC-004**: Visitors navigate list → detail in one click
- ✅ **SC-005**: Show notes render identically to markdown preview
- ✅ **SC-006**: 95% of episode additions succeed on first attempt
- ✅ **SC-007**: Site builds successfully with up to 100 episodes

---

## Branch Status

**Current Branch**: `002-add-episode-workflow`  
**Status**: Planning complete, ready for implementation  
**Next Command**: `/speckit.tasks` to generate implementation tasks

---

**Planning completed**: October 31, 2025  
**Phase 0 + Phase 1 duration**: ~1 hour  
**Ready for**: Task breakdown and implementation
